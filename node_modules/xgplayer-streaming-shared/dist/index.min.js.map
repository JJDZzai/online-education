{"version":3,"file":"index.min.js","sources":["../src/utils.js","../src/buffer.js","../src/error.js","../src/env.js","../src/logger.js","../src/mse.js","../src/net/types.js","../src/net/error.js","../src/is.js","../src/net/helper.js","../src/event.js","../../../node_modules/eventemitter3/index.js","../src/net/fetch.js","../src/net/xhr.js","../src/net/task.js","../src/streaming-helper.js","../src/net/index.js","../src/net/config.js","../src/services/gap.js","../src/services/sei.js","../src/services/bandwidth.js","../src/services/stats.js","../src/index.umd.js"],"sourcesContent":["export function createPublicPromise () {\n  let res, rej\n  const promise = new Promise((resolve, reject) => {\n    res = resolve\n    rej = reject\n  })\n  promise.used = false\n  promise.resolve = (...args) => {\n    promise.used = true\n    return res(...args)\n  }\n  promise.reject = (...args) => {\n    promise.used = true\n    return rej(...args)\n  }\n  return promise\n}\n\nexport function nowTime () {\n  try {\n    return parseInt(performance.now(), 10)\n  } catch (e) {\n    return new Date().getTime()\n  }\n}\n","export class Buffer {\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static start (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n    // Edge bug: https://bit.ly/2JYLPeB\n    if (buf.length === 1 && buf.start(0) < 0) return 0\n\n    return buf.start(0)\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @returns {number}\n   */\n  static end (buf) {\n    if (!buf || !buf.length) return 0\n\n    // Safari bug: https://bit.ly/2trx6O8\n    if (buf.length === 1 && buf.end(0) - buf.start(0) < 1e-6) return 0\n\n    return buf.end(buf.length - 1)\n  }\n\n  /**\n   * @param {{buffered?: TimeRanges}} b\n   * @returns {TimeRanges | void}\n   */\n  static get (b) {\n    if (!b) return\n    try {\n      return b.buffered\n    } catch (error) {\n      // ignore\n    }\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {[number,number][]}\n   */\n  static buffers (buf, maxHole) {\n    if (!buf || !buf.length) return []\n\n    const buffers = []\n    for (let i = 0, l = buf.length; i < l; i++) {\n      const bufLen = buffers.length\n      if (!bufLen || !maxHole) {\n        buffers.push([buf.start(i), buf.end(i)])\n      } else {\n        const last = buffers[bufLen - 1]\n        const lastEnd = last[1]\n        const start = buf.start(i)\n        if (start - lastEnd <= maxHole) {\n          const end = buf.end(i)\n          if (end > lastEnd) {\n            last[1] = end\n          }\n        } else {\n          buffers.push([buf.start(i), buf.end(i)])\n        }\n      }\n    }\n    return buffers\n  }\n\n  /**\n   * @param {TimeRanges} buf\n   * @param {number} [maxHole]\n   * @returns {{buffers:[number,number][],length:number}}\n   */\n  static totalLength (buffers) {\n    if (!buffers || !buffers.length) return 0\n    return buffers.reduce((a, c) => (a += (c[1] - c[0])), 0)\n  }\n\n  /**\n   *\n   * @param {TimeRanges} buf\n   * @param {number} [pos=0]\n   * @param {number} [maxHole=0]\n   * @returns {{start:number,end:number,buffers:[number,number][],remaining:number,index?:number,nextStart?:number,nextEnd?:number,prevStart?:number,prevEnd?:number}}\n   */\n  static info (buf, pos = 0, maxHole = 0) {\n    if (!buf || !buf.length) return { start: 0, end: 0, buffers: [] }\n\n    let start = 0\n    let end = 0\n    let index = 0\n    let nextStart = 0\n    let nextEnd = 0\n    let prevStart = 0\n    let prevEnd = 0\n    const buffers = Buffer.buffers(buf, maxHole)\n\n    for (let i = 0, l = buffers.length; i < l; i++) {\n      const item = buffers[i]\n      if (pos + maxHole >= item[0] && pos < item[1]) {\n        start = item[0]\n        end = item[1]\n        index = i\n      } else if (pos + maxHole < item[0]) {\n        nextStart = item[0]\n        nextEnd = item[1]\n        break\n      } else if (pos + maxHole > item[1]) {\n        prevStart = item[0]\n        prevEnd = item[1]\n      }\n    }\n\n    return {\n      start,\n      end,\n      index,\n      buffers,\n      nextStart,\n      nextEnd,\n      prevStart,\n      prevEnd,\n      currentTime: pos,\n      behind: pos - start,\n      remaining: end ? end - pos : 0,\n      length: Buffer.totalLength && Buffer.totalLength(buffers)\n    }\n  }\n}\n","export const ERR = {\n  MANIFEST: 'manifest',\n  NETWORK: 'network',\n  NETWORK_TIMEOUT: 'network_timeout',\n  NETWORK_FORBIDDEN:'network_forbidden',\n  NETWROK_RANGE_NOT_SATISFIABLE:'network_range_not_satisfiable',\n  DEMUX: 'demux',\n  REMUX: 'remux',\n  MEDIA: 'media',\n  DRM: 'drm',\n  OTHER: 'other',\n  RUNTIME:'runtime',\n\n  SUB_TYPES: {\n    FLV: 'FLV',\n    HLS: 'HLS',\n    MP4: 'MP4',\n    FMP4: 'FMP4',\n    MSE_ADD_SB: 'MSE_ADD_SB',\n    MSE_APPEND_BUFFER: 'MSE_APPEND_BUFFER',\n    MSE_OTHER: 'MSE_OTHER',\n    MSE_FULL: 'MSE_FULL',\n    OPTION: 'OPTION',\n    DASH:'DASH',\n    LICENSE:'LICENSE',\n    CUSTOM_LICENSE:'CUSTOM_LICENSE',\n    MSE_HIJACK:'MSE_HIJACK',\n    EME_HIJACK:'EME_HIJACK',\n    SIDX:'SIDX',\n    NO_CANPLAY_ERROR:'NO_CANPLAY_ERROR',\n    BUFFERBREAK_ERROR:'BUFFERBREAK_ERROR',\n    MEDIA_ERR_ABORTED:'MEDIA_ERR_ABORTED',\n    MEDIA_ERR_NETWORK:'MEDIA_ERR_NETWORK',\n    MEDIA_ERR_DECODE:'MEDIA_ERR_DECODE',\n    MEDIA_ERR_SRC_NOT_SUPPORTED:'MEDIA_ERR_SRC_NOT_SUPPORTED',\n    MEDIA_ERR_CODEC_NOT_SUPPORTED:'MEDIA_ERR_CODEC_NOT_SUPPORTED',\n    MEDIA_ERR_URL_EMPTY:'MEDIA_ERR_URL_EMPTY'\n  }\n}\n\nexport const ERR_CODE = {\n  [ERR.MANIFEST]: {\n    HLS: 1100,\n    DASH:1200\n  },\n  [ERR.NETWORK]: 2100,\n  [ERR.NETWORK_TIMEOUT]: 2101,\n  [ERR.NETWORK_FORBIDDEN]:2103,\n  [ERR.NETWROK_RANGE_NOT_SATISFIABLE]:2116,\n  [ERR.DEMUX]: {\n    FLV: 3100,\n    HLS: 3200,\n    MP4: 3300,\n    FMP4: 3400,\n    SIDX: 3410\n  },\n  [ERR.REMUX]: {\n    FMP4: 4100,\n    MP4: 4200\n  },\n  [ERR.MEDIA]: {\n    MEDIA_ERR_ABORTED: 5101,\n    MEDIA_ERR_NETWORK: 5102,\n    MEDIA_ERR_DECODE: 5103,\n    MEDIA_ERR_SRC_NOT_SUPPORTED: 5104,\n    MEDIA_ERR_CODEC_NOT_SUPPORTED: 5105,\n    MEDIA_ERR_URL_EMPTY: 5106,\n    MSE_ADD_SB: 5200,\n    MSE_APPEND_BUFFER: 5201,\n    MSE_OTHER: 5202,\n    MSE_FULL: 5203,\n    MSE_HIJACK:5204,\n    EME_HIJACK:5301\n  },\n  [ERR.DRM]:{\n    LICENSE:7100,\n    CUSTOM_LICENSE:7200\n  },\n  [ERR.OTHER]: 8000,\n  [ERR.RUNTIME]:{\n    NO_CANPLAY_ERROR:9001,\n    BUFFERBREAK_ERROR:9002\n  }\n}\n\nexport class StreamingError extends Error {\n  constructor (type, subType, origin, payload, msg) {\n    super(msg || origin?.message)\n    this.errorType = type === ERR.NETWORK_TIMEOUT ? ERR.NETWORK : type\n    this.originError = origin\n    this.ext = payload\n    this.errorCode = ERR_CODE[type][subType] || ERR_CODE[type]\n    this.errorMessage = this.message\n    if (!this.errorCode) {\n      this.errorType = ERR.OTHER\n      this.errorCode = ERR_CODE[this.errorType]\n    }\n  }\n\n  static create (type, subType, origin, payload, msg) {\n    if (type instanceof StreamingError) {\n      return type\n    } else if (type instanceof Error) {\n      origin = type\n      type = ''\n    }\n\n    if (!type) type = ERR.OTHER\n\n    return new StreamingError(type, subType, origin, payload, msg)\n  }\n\n  static network (error) {\n    return new StreamingError(\n      error?.isTimeout ? ERR.NETWORK_TIMEOUT : ERR.NETWORK,\n      null,\n      error instanceof Error ? error : null,\n      {\n        url: error?.url,\n        response: error?.response,\n        httpCode: error?.response?.status\n      }\n    )\n  }\n}\n","export const isBrowser = typeof window !== 'undefined'\n","\nexport const LogCacheLevel = {\n  'DEBUG': 1,\n  'LOG': 2,\n  'WARN': 3,\n  'ERROR': 4\n}\nconst LOG_MAX_SIZE = 200 * 1024\nconst SIMPLE_TYPE = ['Boolean', 'Number' ,'String', 'Undefined','Null', 'Date','Object']\nexport class Logger {\n  constructor (name,config) {\n    this.name = name || ''\n    this._prefix = `[${this.name}]`\n    Logger.disabled = config?.disabled || true\n    this.logCacheLevel = config?.logCacheLevel || 3\n    this.logMaxSize = config?.logMaxSize || LOG_MAX_SIZE\n    this.logSize = 0\n    this.logTextArray = []\n  }\n\n  debug (...args) {\n    this.logCache(LogCacheLevel.DEBUG,...args)\n    if (Logger.disabled) return\n    console.debug(this._prefix, nowTime(), ...args)\n  }\n\n  log (...args) {\n    this.logCache(LogCacheLevel.LOG,...args)\n    if (Logger.disabled) return\n    console.log(this._prefix, nowTime(), ...args)\n  }\n\n  warn (...args) {\n    this.logCache(LogCacheLevel.WARN,...args)\n    if (Logger.disabled) return\n    console.warn(this._prefix, nowTime(), ...args)\n  }\n\n  error (...args) {\n    this.logCache(LogCacheLevel.ERROR,...args)\n    if (Logger.disabled) return\n    console.error(this._prefix, nowTime(), ...args)\n  }\n\n  logCache (logCacheLevel, ...logText) {\n    if (logCacheLevel < this.logCacheLevel) return\n    let text = ''\n    try {\n      const finLogText = logText.map( item => logable(item))\n      text = this._prefix + nowTime() + (JSON.stringify(finLogText))\n    } catch (e) {\n      return\n    }\n    if (logCacheLevel >= this.logCacheLevel) {\n      this.logSize += text.length\n      this.logTextArray.push(text)\n    }\n    if (this.logSize > this.logMaxSize) {\n      const delLog = this.logTextArray.shift()\n      this.logSize -= delLog.length\n    }\n  }\n\n  getLogCache () {\n    const logText = this.logTextArray.join('\\n')\n    this.reset()\n    return logText\n  }\n\n  reset () {\n    this.logTextArray = []\n    this.logSize = 0\n  }\n\n  table (...args) {\n    if (Logger.disabled) return\n    console.group(this._prefix)\n    console.table(...args)\n    console.groupEnd()\n  }\n\n  static disabled = true\n\n  static enable () {\n    Logger.disabled = false\n  }\n\n  static disable () {\n    Logger.disabled = true\n  }\n\n  setLogLevel (val) {\n    this.logCacheLevel = val\n  }\n}\nfunction nowTime () {\n  return new Date().toLocaleString()\n}\n\nfunction reduceDepth (val) {\n  if (typeof val !== 'object') {\n    return val\n  }\n  const objType = Object.prototype.toString.call(val).slice(8, -1)\n  switch (objType) {\n    case 'Array':\n    case 'Uint8Array':\n    case 'ArrayBuffer':\n\n      return objType + '[' + val.length + ']'\n    case 'Object':\n      return '{}'\n    default:\n      return objType\n  }\n}\n\nfunction logable (obj, maxDepth, depth) {\n  if (!depth) depth = 1\n  if (!maxDepth) maxDepth = 2\n  const result = {}\n\n  if (!obj || typeof obj !== 'object') {\n    return obj\n  }\n\n  const objType = Object.prototype.toString.call(obj).slice(8, -1)\n  if (!SIMPLE_TYPE.includes(objType)) {\n    return objType\n  }\n\n  if (depth > maxDepth) {\n    return undefined\n  }\n\n\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      if (depth === maxDepth) {\n        result[key] = reduceDepth(obj[key])\n      } else if (typeof obj[key] === 'object') {\n        result[key] = logable(obj[key], maxDepth, depth + 1)\n      } else {\n        result[key] = obj[key]\n      }\n    }\n  }\n  return result\n}\n\n","/* eslint-disable no-undef */\nimport { createPublicPromise, nowTime } from './utils'\nimport { Buffer } from './buffer'\nimport { StreamingError, ERR } from './error'\nimport { isBrowser } from './env'\nimport { Logger } from './logger'\n\nfunction getMediaSource () {\n  try {\n    return isBrowser ? window.MediaSource : null\n  } catch (e) {}\n}\n\nconst MediaSource = getMediaSource()\n\n/** @enum {string} */\nexport const MSEErrorType = {\n  UPDATE_ERROR: 'updateError'\n}\n\nconst OP_NAME = {\n  APPEND: 'appendBuffer',\n  REMOVE: 'removeBuffer'\n}\n\nexport class MSEError extends Error {\n  /**\n   * @param {MSEErrorType} type\n   * @param {any} [msg]\n   */\n  constructor (type, msg) {\n    super(msg || type)\n    this.type = type\n    this.msg = msg\n  }\n}\n\nexport class MSE {\n  /** @type { HTMLMediaElement | null } */\n  media = null\n\n  /** @type { MediaSource | null } */\n  mediaSource = null\n\n  _openPromise = createPublicPromise()\n\n  _queue = Object.create(null)\n\n  _sourceBuffer = Object.create(null)\n\n  static VIDEO = 'video'\n\n  static AUDIO = 'audio'\n\n  _mseFullFlag = {}\n\n  _st = 0\n\n  _opst = 0\n\n  _logger = null\n\n  _config = null\n  _url = null\n\n\n  static getDefaultConfig () {\n    return {\n      openLog: false\n    }\n  }\n\n  /**\n   * @param {HTMLMediaElement} [media]\n   */\n  constructor (media, config) {\n    this._config = Object.assign(MSE.getDefaultConfig(), config)\n    if (media) this.bindMedia(media)\n    this._logger = new Logger('MSE')\n    if (this._config.openLog) {\n      Logger.enable()\n    }\n  }\n\n  get isOpened () {\n    return this.mediaSource?.readyState === 'open'\n  }\n\n  get url () {\n    return this._url\n  }\n\n  get duration () {\n    return this.mediaSource?.duration || -1\n  }\n\n  get isEnded () {\n    return this.mediaSource ? this.mediaSource.readyState === 'ended' : false\n  }\n\n  isFull (type) {\n    return type ? this._mseFullFlag[type] : this._mseFullFlag[MSE.VIDEO]\n  }\n\n  /**\n   * @param { number } duration\n   * @return { Promise }\n   */\n  updateDuration (duration) {\n    // 设置值比当前值小，会导致异常\n    if (this.mediaSource && this.mediaSource.duration > duration) {\n      return Promise.resolve()\n    }\n\n    return this._enqueueBlockingOp(() => {\n      if (this.isEnded) {\n        this._logger.debug('[debug mse] setDuration ended')\n        return\n      }\n      if (this.mediaSource) {\n        this.mediaSource.duration = duration\n        this._logger.debug('[debug mse] setDuration')\n      }\n    }, 'updateDuration')\n  }\n\n  /** @return { Promise } */\n  open () {\n    if (this._openPromise.used && !this.isOpened && this.mediaSource) {\n      const ms = this.mediaSource\n      const onOpen = () => {\n        const costtime = nowTime() - this._st\n        this._logger.debug('MSE OPEN', costtime)\n        ms.removeEventListener('sourceopen', onOpen)\n        this._openPromise.resolve({costtime})\n      }\n      ms.addEventListener('sourceopen', onOpen)\n      this._openPromise = createPublicPromise()\n    }\n\n    return this._openPromise\n  }\n\n  /**\n   * @param { HTMLMediaElement } media\n   * @return { Promise }\n   */\n  async bindMedia (media) {\n    if (this.mediaSource || this.media) await this.unbindMedia()\n    if (!media || !MediaSource) throw new Error('Param media or MediaSource does not exist')\n    this.media = media\n    const ms = this.mediaSource = new MediaSource()\n    this._st = nowTime()\n\n    const onOpen = () => {\n      const costtime = nowTime() - this._st\n      this._logger.debug('MSE OPEN')\n      ms.removeEventListener('sourceopen', onOpen)\n      URL.revokeObjectURL(media.src)\n      this._openPromise.resolve({costtime})\n    }\n    ms.addEventListener('sourceopen', onOpen)\n    this._url = URL.createObjectURL(ms)\n    media.src = this._url\n    return this._openPromise\n  }\n\n  /** @return { Promise } */\n  async unbindMedia () {\n    if (!this._openPromise.used) this._openPromise.resolve()\n    const ms = this.mediaSource\n\n    if (ms) {\n      Object.keys(this._queue).forEach((t) => {\n        const queue = this._queue[t]\n        if (queue) {\n          queue.forEach(x => x.promise.resolve)\n        }\n      })\n\n      const hasMetadata = !!this.media && this.media.readyState >= 1\n      const mseOpen = ms.readyState === 'open'\n\n      if (hasMetadata && mseOpen) {\n        try {\n          ms.endOfStream()\n        } catch (error) {\n          // ignore\n        }\n      }\n\n      Object.keys(this._sourceBuffer).forEach(k => {\n        try {\n          ms.removeSourceBuffer(this._sourceBuffer[k])\n        } catch (error) {\n          // ignore\n        }\n      })\n    }\n\n    if (this.media) {\n      this.media.removeAttribute('src')\n      try {\n        this.media.load()\n      } catch (error) {\n        // ignore\n      }\n      this.media = null\n    }\n\n    this.mediaSource = null\n    this._openPromise = createPublicPromise()\n    this._queue = Object.create(null)\n    this._sourceBuffer = Object.create(null)\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   */\n  createSource (type, mimeType) {\n    if (this._sourceBuffer[type] || !this.mediaSource) return\n    let sb\n    try {\n      sb = this._sourceBuffer[type] = this.mediaSource.addSourceBuffer(mimeType)\n    } catch (error) {\n      throw new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_ADD_SB, error)\n    }\n    sb.mimeType = mimeType\n    sb.addEventListener('updateend', this._onSBUpdateEnd.bind(this, type))\n    sb.addEventListener('error', this._onSBUpdateError.bind(this, type))\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  changeType (type, mimeType) {\n    const sb = this._sourceBuffer[type]\n    if (!this.mediaSource || !sb || sb.mimeType === mimeType) return Promise.resolve()\n\n    if (typeof sb.changeType !== 'function') return Promise.reject()\n\n    return this._enqueueOp(type, () => {\n      sb.changeType(mimeType)\n      sb.mimeType = mimeType\n      this._onSBUpdateEnd(type)\n    })\n  }\n\n  /**\n   * @param { string } type\n   * @param { string } mimeType\n   * @return { Promise }\n   */\n  createOrChangeSource (type, mimeType) {\n    this.createSource(type, mimeType)\n    return this.changeType(type, mimeType)\n  }\n\n  /**\n   * @param { string } type\n   * @param { BufferSource } buffer\n   * @return { Promise }\n   */\n  append (type, buffer, context) {\n    if (!buffer || !buffer.byteLength) {\n      return Promise.resolve()\n    }\n\n    if (!this._sourceBuffer[type]) return Promise.resolve()\n\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource) return\n      this._logger.debug('MSE APPEND START', context)\n      this._opst = nowTime()\n      this._sourceBuffer[type]?.appendBuffer(buffer)\n    }, OP_NAME.APPEND, context)\n\n  }\n\n  /**\n   * @param { string } type\n   * @param { number } startTime\n   * @param { number } endTime\n   * @return { Promise }\n   */\n  remove (type, startTime, endTime, context) {\n    // if (Object.keys(this._sourceBuffer).length === 1) return Promise.resolve()\n    let isInsertHead = false\n    if (this._mseFullFlag[type]) {\n      isInsertHead = true\n    }\n    return this._enqueueOp(type, () => {\n      if (!this.mediaSource) return\n      const sb = this._sourceBuffer[type]\n      if (startTime >= endTime || !sb) {\n        this._onSBUpdateEnd(type)\n        return\n      }\n      this._opst = nowTime()\n      this._logger.debug('MSE REMOVE START', type, startTime, endTime, context)\n      sb.remove(startTime, endTime)\n    }, OP_NAME.REMOVE, context, isInsertHead)\n  }\n\n  clearBuffer (startTime, endTime) {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      p = this._enqueueOp(k, () => {\n        if (!this.mediaSource) return\n        const sb = this._sourceBuffer[k]\n        this._logger.debug('MSE clearBuffer START', k, startTime, endTime)\n        sb.remove(startTime, endTime)\n      })\n    })\n    return p\n  }\n\n  clearAllBuffer () {\n    let p\n    Object.keys(this._sourceBuffer).forEach(k => {\n      p = this._enqueueOp(k, () => {\n        if (!this.mediaSource) return\n        const sb = this._sourceBuffer[k]\n        this._logger.debug('MSE clearAllBuffer START', k)\n        sb.remove(0, Buffer.end(Buffer.get(sb)))\n      })\n    })\n    return p\n  }\n\n  clearOpQueues (type) {\n    this._logger.debug('MSE clearOpQueue START')\n    const queue = this._queue[type]\n    if (!queue || !queue[type] || queue.length < 5) return\n    const initOpque = []\n    queue.forEach(op => {\n      if (op.context && op.context.isinit) {\n        initOpque.push(op)\n      }\n    })\n    this._queue[type] = queue.slice(0, 2)\n    initOpque.length > 0 && this._queue[type].push(...initOpque)\n  }\n\n  /**\n   * @param {EndOfStreamError} [reason]\n   * @returns {Promise}\n   */\n  endOfStream (reason) {\n    if (!this.mediaSource || this.mediaSource.readyState !== 'open') return Promise.resolve()\n    return this._enqueueBlockingOp(() => {\n      const ms = this.mediaSource\n      if (!ms || ms.readyState !== 'open') return\n      this._logger.debug('MSE endOfStream START')\n      if (reason) {\n        ms.endOfStream(reason)\n      } else {\n        ms.endOfStream()\n      }\n    }, 'endOfStream')\n  }\n\n  setLiveSeekableRange (start, end) {\n    const ms = this.mediaSource\n    if (start < 0 || end < start || !ms?.setLiveSeekableRange || ms.readyState !== 'open') return\n    ms.setLiveSeekableRange(start, end)\n  }\n\n  /**\n   * @param {string} type\n   * @returns {?SourceBuffer}\n   */\n  getSourceBuffer (type) {\n    return this._sourceBuffer[type]\n  }\n\n  /**\n   * @param { string } type\n   * @return { TimeRanges | void }\n   */\n  buffered (type) {\n    return Buffer.get(this._sourceBuffer[type])\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferStart (type) {\n    return Buffer.start(this.buffered(type))\n  }\n\n  /**\n   * @param { string } type\n   * @return { number }\n   */\n  bufferEnd (type) {\n    return Buffer.end(this.buffered(type))\n  }\n\n  _enqueueOp (type, exec, opName, context, isInsertHead) {\n    if (!this.mediaSource) return Promise.resolve()\n    const queue = this._queue[type] = this._queue[type] || []\n    const op = {\n      exec,\n      promise: createPublicPromise(),\n      opName,\n      context\n    }\n\n    if (isInsertHead) {\n      queue.splice(0, 0, op)\n      this._mseFullFlag[type] = false\n      this._startQueue(type)\n    } else {\n      queue.push(op)\n    }\n\n    if (this.isOpened) {\n      if (queue.length === 1) {\n        this._startQueue(type)\n      }\n    } else {\n      this._openPromise.then(() => {\n        if (queue.length === 1) {\n          this._startQueue(type)\n        }\n      })\n    }\n\n\n    return op.promise\n  }\n\n  async _enqueueBlockingOp (exec, opName) {\n    if (!this.mediaSource) return Promise.resolve()\n    const types = Object.keys(this._sourceBuffer)\n    if (!types.length) {\n      return exec()\n    }\n\n    const waiters = []\n    types.forEach(t => {\n      const queue = this._queue[t]\n      const prom = createPublicPromise()\n      waiters.push(prom)\n      queue.push({exec: () => prom.resolve(), promise: prom, opName})\n      if (queue.length === 1) {\n        this._startQueue(t)\n      }\n    })\n\n    return Promise.all(waiters).then(() => {\n      try {\n        return exec()\n      } finally {\n        types.forEach(t => {\n          const queue = this._queue[t]\n          const sb = this._sourceBuffer[t]\n          queue?.shift()\n          if (!sb || !sb.updating) {\n            this._startQueue(t)\n          }\n        })\n      }\n    })\n  }\n\n  _startQueue (type) {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op && !this._mseFullFlag[type]) {\n        try {\n          op.exec()\n        } catch (error) {\n          if (error && error.message && error.message.indexOf('SourceBuffer is full') >= 0) {\n            this._mseFullFlag[type] = true\n            this._logger.error('[MSE error],  context,', op.context, ' ,name,', op.opName, ',err,SourceBuffer is full')\n            op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_FULL, error))\n          } else {\n            this._logger.error(error)\n            op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_OTHER, error))\n            queue.shift()\n            this._startQueue(type)\n          }\n        }\n      }\n    }\n  }\n\n  _onSBUpdateEnd = (type) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue.shift()\n      if (op) {\n        const costtime = nowTime() - this._opst\n        this._logger.debug('UpdateEnd', op.opName, costtime, op.context)\n        op.promise.resolve({name: op.opName, context: op.context, costtime})\n        this._startQueue(type)\n      }\n    }\n  }\n\n  _onSBUpdateError = (type, event) => {\n    const queue = this._queue[type]\n    if (queue) {\n      const op = queue[0]\n      if (op) {\n        this._logger.error('UpdateError', type, op.opName, op.context)\n        op.promise.reject(new StreamingError(ERR.MEDIA, ERR.SUB_TYPES.MSE_APPEND_BUFFER, event))\n        // Do not shift from queue, 'updateend' event will fire next\n      }\n    }\n  }\n\n  /**\n   * @param {string} [mime='video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"']\n   * @returns {boolean}\n   */\n  static isSupported (mime = 'video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"') {\n    if (!MediaSource) return false\n    try {\n      return MediaSource.isTypeSupported(mime)\n    } catch (error) {\n      this._logger.error(mime, error)\n      return false\n    }\n  }\n\n  setTimeoffset (type, timestampOffset, context) {\n    return this._enqueueOp(type, () => {\n      if (timestampOffset < 0) {\n        timestampOffset += 0.001\n      }\n      this._sourceBuffer[type].timestampOffset = timestampOffset\n      this._onSBUpdateEnd(type)\n    }, 'setTimeoffset', context)\n  }\n\n  /** *重置decode时间戳 */\n  abort (type, context) {\n    if (!this.isOpened) {\n      return Promise.resolve()\n    }\n    return this._enqueueOp(type, () => {\n      this._sourceBuffer[type].abort()\n      this._onSBUpdateEnd(type)\n    }, 'abort', context)\n  }\n}\n","export const LoaderType = {\n  FETCH: 'fetch',\n  XHR: 'xhr'\n}\n\nexport const ResponseType = {\n  ARRAY_BUFFER: 'arraybuffer',\n  TEXT: 'text',\n  JSON: 'json'\n}\n","import { LoaderType } from './types'\n\nexport class NetError extends Error {\n  retryCount = 0\n  isTimeout = false\n  loaderType = LoaderType.FETCH\n  startTime = 0\n  endTime = 0\n  options = {}\n\n  constructor (url, request, response, msg) {\n    super(msg)\n    this.url = url\n    this.request = request\n    this.response = response\n  }\n}\n","const toString = Object.prototype.toString\n\nexport function isObject (a) {\n  return a !== null && typeof a === 'object'\n}\n\nexport function isPlainObject (val) {\n  if (toString.call(val) !== '[object Object]') {\n    return false\n  }\n\n  const prototype = Object.getPrototypeOf(val)\n  return prototype === null || prototype === Object.prototype\n}\n\nexport function isDate (a) {\n  return toString.call(a) === '[object Date]'\n}\n\nexport function isNumber (n) {\n  return typeof n === 'number' && !Number.isNaN(n)\n}\n","import { isDate, isObject } from '../is'\n\nexport function getRangeValue (value) {\n  if (!value || value[0] === null || value[0] === undefined || (value[0] === 0 && (value[1] === null || value[1] === undefined))) {\n    return\n  }\n  let ret = 'bytes=' + value[0] + '-'\n  if (value[1]) ret += value[1]\n  return ret\n}\n\nfunction encode (val) {\n  return encodeURIComponent(val)\n    .replace(/%3A/gi, ':')\n    .replace(/%24/g, '$')\n    .replace(/%2C/gi, ',')\n    .replace(/%20/g, '+')\n    .replace(/%5B/gi, '[')\n    .replace(/%5D/gi, ']')\n}\n\nexport function setUrlParams (url, params) {\n  if (!url) return\n  if (!params) return url\n  let v\n  const str = Object.keys(params).map(k => {\n    v = params[k]\n    if (v === null || v === undefined) return\n    if (Array.isArray(v)) {\n      k = k + '[]'\n    } else {\n      v = [v]\n    }\n\n    return v.map(x => {\n      if (isDate(x)) {\n        x = x.toISOString()\n      } else if (isObject(x)) {\n        x = JSON.stringify(x)\n      }\n      return `${encode(k)}=${encode(x)}`\n    }).join('&')\n  }).filter(Boolean).join('&')\n\n  if (str) {\n    const hashIndex = url.indexOf('#')\n    if (hashIndex !== -1) {\n      url = url.slice(0, hashIndex)\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + str\n  }\n\n  return url\n}\n\nexport function createResponse (\n  data,\n  done,\n  response,\n  contentLength,\n  age,\n  startTime,\n  firstByteTime,\n  index,\n  range,\n  vid,\n  priOptions\n) {\n  age = (age !== null && age !== undefined) ? parseFloat(age) : null\n  contentLength = parseInt(contentLength || '0', 10)\n  if (Number.isNaN(contentLength)) contentLength = 0\n  const options = { range, vid, index, contentLength, age, startTime, firstByteTime, endTime: Date.now(), priOptions }\n  return { data, done, options, response }\n}\n\nexport function calculateSpeed (byteLen, millisec) {\n  return Math.round(byteLen * 8 * 1000 / millisec / 1024)\n}\n","export const EVENT = {\n  ERROR: 'error',\n\n  TTFB: 'core.ttfb',\n  LOAD_START: 'core.loadstart',\n  LOAD_RESPONSE_HEADERS: 'core.loadresponseheaders',\n  LOAD_COMPLETE: 'core.loadcomplete',\n  LOAD_RETRY: 'core.loadretry',\n  SOURCEBUFFER_CREATED: 'core.sourcebuffercreated',\n  ANALYZE_DURATION_EXCEEDED: 'core.analyzedurationexceeded',\n  REMOVE_BUFFER: 'core.removebuffer',\n  BUFFEREOS: 'core.buffereos',\n  KEYFRAME: 'core.keyframe',\n  METADATA_PARSED: 'core.metadataparsed',\n  SEI: 'core.sei',\n  SEI_IN_TIME: 'core.seiintime',\n  FLV_SCRIPT_DATA: 'core.flvscriptdata',\n  LOWDECODE: 'core.lowdecode',\n  SWITCH_URL_SUCCESS: 'core.switchurlsuccess',\n  SWITCH_URL_FAILED: 'core.switchurlfailed',\n  SPEED: 'core.speed',\n  HLS_MANIFEST_LOADED: 'core.hlsmanifestloaded',\n  HLS_LEVEL_LOADED: 'core.hlslevelloaded',\n  DEMUXED_TRACK:'core.demuxedtrack',\n\n  STREAM_EXCEPTION: 'core.streamexception',\n  LARGE_AV_FIRST_FRAME_GAP_DETECT: 'LARGE_AV_FIRST_FRAME_GAP_DETECT',\n  LARGE_VIDEO_DTS_GAP_DETECT: 'LARGE_VIDEO_DTS_GAP_DETECT',\n  LARGE_AUDIO_DTS_GAP_DETECT: 'LARGE_AUDIO_DTS_GAP_DETECT',\n  AUDIO_GAP_DETECT: 'AUDIO_GAP_DETECT',\n  AUDIO_OVERLAP_DETECT: 'AUDIO_OVERLAP_DETECT',\n  MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT: 'MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT',\n  REAL_TIME_SPEED: 'real_time_speed'\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nconst CACHESIZE = 2 * 1024 * 1024\nexport class FetchLoader extends EventEmitter {\n  _abortController = null\n  _timeoutTimer = null\n  _reader = null\n  _response = null\n  _aborted = false\n  _index = -1\n  _range = null\n  _receivedLength = 0\n  _running = false\n  _logger = null\n  _vid = ''\n  _onProcessMinLen = 0\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n  constructor () {\n    super()\n  }\n\n  load ({\n    url,\n    vid,\n    timeout, // ms\n    responseType,\n    onProgress,\n    index,\n    onTimeout,\n    onCancel,\n    range,\n    transformResponse,\n    request,\n    params,\n    logger,\n\n    method,\n    headers,\n    body,\n    mode,\n    credentials,\n    cache,\n    redirect,\n    referrer,\n    referrerPolicy,\n    onProcessMinLen,\n    priOptions\n  }) {\n    this._logger = logger\n    this._aborted = false\n    this._onProcessMinLen = onProcessMinLen\n    this._onCancel = onCancel\n    this._abortController = typeof AbortController !== 'undefined' && new AbortController()\n    this._running = true\n    this._index = index\n    this._range = range || [0, 0]\n    this._vid = vid || url\n    this._priOptions = priOptions || {}\n    const init = {\n      method,\n      headers,\n      body,\n      mode,\n      credentials,\n      cache,\n      redirect,\n      referrer,\n      referrerPolicy,\n      signal: this._abortController?.signal\n    }\n\n    let isTimeout = false\n    clearTimeout(this._timeoutTimer)\n\n    url = setUrlParams(url, params)\n\n    const rangeValue = getRangeValue(range)\n    if (rangeValue) {\n      if (request) {\n        headers = request.headers\n      } else {\n        headers = init.headers = init.headers || (Headers ? new Headers() : {})\n      }\n      if (Headers && headers instanceof Headers) {\n        headers.append('Range', rangeValue)\n      } else {\n        headers.Range = rangeValue\n      }\n    }\n\n    if (timeout) {\n      this._timeoutTimer = setTimeout(() => {\n        isTimeout = true\n        this.cancel()\n        if (onTimeout) {\n          const error = new NetError(url, init, null, 'timeout')\n          error.isTimeout = true\n          onTimeout(error, {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n      }, timeout)\n    }\n\n    const startTime = Date.now()\n    this._logger.debug('[fetch load start], index,', index, ',range,', range)\n    return new Promise((resolve, reject) => {\n      fetch(request || url, request ? undefined : init).then(async (response) => {\n        clearTimeout(this._timeoutTimer)\n        this._response = response\n        if (this._aborted || !this._running) return\n        if (transformResponse) {\n          response = transformResponse(response, url) || response\n        }\n        if (!response.ok) {\n          throw new NetError(url, init, response, 'bad network response')\n        }\n\n        const firstByteTime = Date.now()\n        let data\n        if (responseType === ResponseType.TEXT) {\n          data = await response.text()\n          this._running = false\n        } else if (responseType === ResponseType.JSON) {\n          data = await response.json()\n          this._running = false\n        } else {\n          if (onProgress) {\n            this.resolve = resolve\n            this.reject = reject\n            this._loadChunk(response, onProgress, startTime, firstByteTime)\n            return\n          } else {\n            data = await response.arrayBuffer()\n            data = new Uint8Array(data)\n            this._running = false\n            const costTime = Date.now() - startTime\n            const speed = calculateSpeed(data.byteLength, costTime)\n            this.emit(EVENT.REAL_TIME_SPEED, {speed,len: data.byteLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n          }\n        }\n        this._logger.debug('[fetch load end], index,', index, ',range,', range)\n        resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          startTime,\n          firstByteTime,\n          index,\n          range,\n          this._vid,\n          this._priOptions\n        ))\n      }).catch((error) => {\n        clearTimeout(this._timeoutTimer)\n        this._running = false\n        if (this._aborted && !isTimeout) return\n        error = error instanceof NetError ? error : new NetError(url, init, null, error?.message)\n        error.startTime = startTime\n        error.endTime = Date.now()\n        error.isTimeout = isTimeout\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        reject(error)\n      })\n    })\n  }\n\n  async cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._running = false\n    if (this._response) {\n      try {\n        // await this._response.body.cancel()\n        if (this._reader) {\n          await this._reader.cancel()\n        }\n      } catch (error) {\n        // ignore\n      }\n      this._response = this._reader = null\n    }\n\n    if (this._abortController) {\n      try {\n        this._abortController.abort()\n      } catch (error) {\n        // ignore\n      }\n      this._abortController = null\n    }\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n  }\n\n  _loadChunk (response, onProgress, st, firstByteTime) {\n    if (!response.body || !response.body.getReader) {\n      this._running = false\n      const err = new NetError(response.url, '', response, 'onProgress of bad response.body.getReader')\n      err.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      this.reject(err)\n      return\n    }\n    if (this._onProcessMinLen > 0) {\n      this._cache = new Uint8Array(CACHESIZE)\n      this._writeIdx = 0\n    }\n    const reader = this._reader = response.body.getReader()\n    let data\n\n    let startTime\n    let endTime\n    const pump = async () => {\n      startTime = Date.now()\n      try {\n        data = await reader.read()\n        endTime = Date.now()\n      } catch (e) {\n        // request aborted\n        endTime = Date.now()\n        if (!this._aborted) {\n          this._running = false\n          e.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n          this.reject(e)\n        }\n        return\n      }\n      const startRange = this._range?.length > 0 ? this._range[0] : 0\n      const startByte = startRange + this._receivedLength\n      if (this._aborted) {\n        this._running = false\n        onProgress(undefined, false, { range: [startByte, startByte], vid: this._vid, index: this._index, startTime, endTime, st, firstByteTime, priOptions:this._priOptions }, response)\n        return\n      }\n      const curLen = data.value ? data.value.byteLength : 0\n      this._receivedLength += curLen\n      this._logger.debug('【fetchLoader,onProgress call】,task,', this._range, ', start,', startByte, ', end,', startRange + this._receivedLength, ', done,', data.done)\n      let retData\n      if (this._onProcessMinLen > 0) {\n        if (this._writeIdx + curLen >= this._onProcessMinLen || data.done) {\n          retData = new Uint8Array(this._writeIdx + curLen)\n          retData.set(this._cache.slice(0, this._writeIdx), 0)\n          curLen > 0 && retData.set(data.value, this._writeIdx)\n          this._writeIdx = 0\n          this._logger.debug('【fetchLoader,onProgress enough】,done,', data.done, ',len,', retData.byteLength, ', writeIdx,', this._writeIdx)\n        } else {\n          if (curLen > 0 && this._writeIdx + curLen < CACHESIZE) {\n            this._cache.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            this._logger.debug('【fetchLoader,onProgress cache】,len,', curLen, ', writeIdx,', this._writeIdx)\n          } else if (curLen > 0) {\n            const temp = new Uint8Array(this._writeIdx + curLen + 2048)\n            this._logger.debug('【fetchLoader,onProgress extra start】,size,', this._writeIdx + curLen + 2048, ', datalen,', curLen, ', writeIdx,', this._writeIdx)\n            temp.set(this._cache.slice(0, this._writeIdx), 0)\n            curLen > 0 && temp.set(data.value, this._writeIdx)\n            this._writeIdx += curLen\n            delete this._cache\n            this._cache = temp\n            this._logger.debug('【fetchLoader,onProgress extra end】,len,', curLen, ', writeIdx,', this._writeIdx)\n          }\n        }\n      } else {\n        retData = data.value\n      }\n      if (retData && retData.byteLength > 0 || data.done) {\n        onProgress(retData, data.done, {\n          range: [this._range[0] + this._receivedLength - (retData ? retData.byteLength : 0), this._range[0] + this._receivedLength],\n          vid: this._vid,\n          index: this._index,\n          startTime,\n          endTime,\n          st,\n          firstByteTime,\n          priOptions:this._priOptions\n        }, response)\n      }\n      if (!data.done) {\n        pump()\n      } else {\n        const costTime = Date.now() - st\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed,len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: this._range, priOptions: this._priOptions})\n        this._running = false\n        this._logger.debug('[fetchLoader onProgress end],task,', this._range, ',done,', data.done)\n        this.resolve(createResponse(\n          data,\n          true,\n          response,\n          response.headers.get('Content-Length'),\n          response.headers.get('age'),\n          st,\n          firstByteTime,\n          this._index,\n          this._range,\n          this._vid,\n          this._priOptions\n        ))\n      }\n    }\n    pump()\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  static isSupported () {\n    return !!(typeof fetch !== 'undefined')\n  }\n}\n","import { NetError } from './error'\nimport { createResponse, getRangeValue, setUrlParams, calculateSpeed } from './helper'\nimport { ResponseType } from './types'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\nexport class XhrLoader extends EventEmitter {\n\n  _xhr = null\n  _aborted = false\n  _timeoutTimer = null\n  _range = null\n  _receivedLength = 0\n  _url = null\n  _onProgress = null\n  _index = -1\n  _headers = null\n  // _chunkSizeKBList = [\n  //   128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192\n  // ]\n\n  _currentChunkSizeKB = 384\n  _timeout = null\n  _xhr = null\n  _withCredentials = null\n  _startTime = -1\n  // _speedSampler = new SpeedSampler()\n  _loadCompleteResolve = null\n  _loadCompleteReject = null\n  _runing = false\n  _logger = false\n  _vid = ''\n  _responseType\n  _credentials\n  _method\n  _transformResponse\n  _firstRtt\n  _onCancel = null\n  _priOptions = null // 比较私有化的参数传递，回调时候透传\n\n\n  constructor () {\n    super()\n  }\n\n  load (req) {\n    clearTimeout(this._timeoutTimer)\n    this._logger = req.logger\n    this._range = req.range\n    this._onProgress = req.onProgress\n    this._index = req.index\n    this._headers = req.headers\n    this._withCredentials = req.credentials === 'include' || req.credentials === 'same-origin'\n    this._body = req.body || null\n    req.method && (this._method = req.method)\n    this._timeout = req.timeout || null\n    this._runing = true\n    this._vid = req.vid || req.url\n    this._responseType = req.responseType\n    this._firstRtt = -1\n    this._onTimeout = req.onTimeout\n    this._onCancel = req.onCancel\n    this._request = req.request\n    this._priOptions = req.priOptions || {}\n    this._logger.debug('【xhrLoader task】, range', this._range)\n\n    this._url = setUrlParams(req.url, req.params)\n\n    const startTime = Date.now()\n    return new Promise((resolve, reject) => {\n      this._loadCompleteResolve = resolve\n      this._loadCompleteReject = reject\n      this._startLoad()\n    }).catch((error) => {\n      clearTimeout(this._timeoutTimer)\n      this._runing = false\n      if (this._aborted) return\n      error = error instanceof NetError ? error : new NetError(this._url, this._request)\n      error.startTime = startTime\n      error.endTime = Date.now()\n      error.options = {index: this._index, vid: this._vid, priOptions: this._priOptions}\n      throw error\n    })\n  }\n\n  _startLoad () {\n    let range = null\n    if (this._responseType === ResponseType.ARRAY_BUFFER && this._range && this._range.length > 1) {\n      if (this._onProgress) {\n        this._firstRtt = -1\n        const chunkSize = this._currentChunkSizeKB * 1024\n        const from = this._range[0] + this._receivedLength\n        let to = this._range[1]\n        if (chunkSize < this._range[1] - from) {\n          to = from + chunkSize\n        }\n        range = [from, to]\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', SubRange, ', range)\n      } else {\n        range = this._range\n        this._logger.debug('[xhr_loader->],tast :', this._range, ', allRange, ', range)\n      }\n    }\n    this._internalOpen(range)\n  }\n\n  _internalOpen (range) {\n    try {\n      this._startTime = Date.now()\n      const xhr = this._xhr = new XMLHttpRequest()\n      xhr.open(this._method || 'GET', this._url, true)\n      xhr.responseType = this._responseType\n      this._timeout && (xhr.timeout = this._timeout)\n      xhr.withCredentials = this._withCredentials\n      xhr.onload = this._onLoad.bind(this)\n      xhr.onreadystatechange = this._onReadyStatechange.bind(this)\n      xhr.onerror = (errorEvent) => {\n        this._running = false\n        const error = new NetError(this._url, this._request, errorEvent?.currentTarget?.response, ('xhr.onerror.status:' + errorEvent?.currentTarget?.status + ',statusText,' + errorEvent?.currentTarget?.statusText))\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      xhr.ontimeout = (event) => {\n        this.cancel()\n        const error = new NetError(this._url, this._request, {status:408}, 'timeout')\n        if (this._onTimeout) {\n          error.isTimeout = true\n          this._onTimeout(error,{index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n        }\n        error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n        this._loadCompleteReject(error)\n      }\n      const headers = this._headers || {}\n      const rangeValue = getRangeValue(range)\n      if (rangeValue) {\n        headers.Range = rangeValue\n      }\n      if (headers) {\n        Object.keys(headers).forEach(k => {\n          xhr.setRequestHeader(k, headers[k])\n        })\n      }\n      this._logger.debug('[xhr.send->] tast,', this._range, ',load sub range, ', range)\n      xhr.send(this._body)\n    } catch (e) {\n      e.options = {index: this._index, range, vid: this._vid, priOptions: this._priOptions}\n      this._loadCompleteReject(e)\n    }\n  }\n\n  _onReadyStatechange (e) {\n    const xhr = e.target\n    if (xhr.readyState === 2) {\n      this._firstRtt < 0 && (this._firstRtt = Date.now())\n    }\n  }\n\n  _onLoad (e) {\n    const status = e.target.status\n    if (status < 200 || status > 299) {\n      const error = new NetError(this._url, null, { ...e.target.response, status }, 'bad response,status:' + status)\n      error.options = {index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions}\n      return this._loadCompleteReject(error)\n    }\n    let data = null\n    let done = false\n    let byteStart\n    const startRange = (this._range?.length > 0 ? this._range [0] : 0 )\n    if (this._responseType === ResponseType.ARRAY_BUFFER) {\n      const chunk = new Uint8Array(e.target.response)\n      byteStart = startRange + this._receivedLength\n      if (chunk && chunk.byteLength > 0) {\n        this._receivedLength += chunk.byteLength\n        const costTime = Date.now() - this._startTime\n        const speed = calculateSpeed(this._receivedLength, costTime)\n        this.emit(EVENT.REAL_TIME_SPEED, {speed, len: this._receivedLength, time: costTime, vid: this._vid, index: this._index, range: [byteStart, startRange + this._receivedLength], priOptions: this._priOptions})\n      }\n      data = chunk\n      if (this._range?.length > 1 && this._range[1] && this._receivedLength < this._range[1] - this._range[0]) {\n        done = false\n      } else {\n        done = true\n      }\n      this._logger.debug('[xhr load done->], tast :', this._range, ', start', byteStart, 'end ', startRange + this._receivedLength, ',dataLen,', (chunk ? chunk.byteLength : 0), ',receivedLength', this._receivedLength, ',index,', this._index, ', done,', done)\n    } else {\n      done = true\n      data = e.target.response\n    }\n    let response = {\n      ok: status >= 200 && status < 300,\n      status,\n      statusText: this._xhr.statusText,\n      url: this._xhr.responseURL,\n      headers: this._getHeaders(this._xhr),\n      body: this._xhr.response\n    }\n    if (this._transformResponse) {\n      response = this._transformResponse(response, this._url) || response\n    }\n    if (this._onProgress) {\n      this._onProgress(data, done, { index: this._index, vid: this._vid, range: [byteStart, startRange + this._receivedLength], startTime: this._startTime, endTime: Date.now(), priOptions: this._priOptions }, response)\n    }\n\n    if (!done) {\n      this._startLoad()\n    } else {\n      this._runing = false\n      this._loadCompleteResolve && this._loadCompleteResolve(createResponse(\n        this._onProgress ? null : data,\n        done,\n        response,\n        response.headers['content-length'],\n        response.headers.age,\n        this._startTime,\n        this._firstRtt,\n        this._index,\n        this._range,\n        this._vid,\n        this._priOptions\n      ))\n    }\n  }\n\n  cancel () {\n    if (this._aborted) return\n    this._aborted = true\n    this._runing = false\n    super.removeAllListeners()\n    if (this._onCancel) {\n      this._onCancel({index: this._index, range: this._range, vid: this._vid, priOptions: this._priOptions})\n    }\n    if (this._xhr) {\n      return this._xhr.abort()\n    }\n  }\n\n  static isSupported () {\n    return typeof XMLHttpRequest !== 'undefined'\n  }\n\n  get receiveLen () {\n    return this._receivedLength\n  }\n\n  get running () {\n    return this._running\n  }\n\n  set running (status) {\n    this._running = status\n  }\n\n  _getHeaders (xhr) {\n    const headerLines = xhr.getAllResponseHeaders().trim().split('\\r\\n')\n    const headers = {}\n    for (const header of headerLines) {\n      const parts = header.split(': ')\n      headers[parts[0].toLowerCase()] = parts.slice(1).join(': ')\n    }\n    return headers\n  }\n}\n","import { FetchLoader } from './fetch'\nimport { XhrLoader } from './xhr'\nimport { LoaderType } from './types'\nimport { createPublicPromise } from '../utils'\nimport { Logger } from '../logger'\n\nexport class Task {\n  constructor (type, config) {\n    this.promise = createPublicPromise()\n    this.alive = !!config.onProgress\n    !config.logger && (config.logger = new Logger('Loader'))\n    this._loaderType = type\n    this._loader = type === LoaderType.FETCH && !!window.fetch ? new FetchLoader() : new XhrLoader()\n    this._config = config\n    this._retryCount = 0\n    this._retryTimer = null\n    this._canceled = false\n    this._retryCheckFunc = config.retryCheckFunc\n    this._logger = config.logger\n  }\n\n  exec () {\n    const {\n      retry,\n      retryDelay,\n      onRetryError,\n      transformError,\n      ...rest\n    } = this._config\n\n    const request = async () => {\n      try {\n        const response = await this._loader.load(rest)\n        this.promise.resolve(response)\n      } catch (e) {\n        this._loader.running = false\n        this._logger.debug('[task request catch err]', e)\n        if (this._canceled) return\n\n        e.loaderType = this._loaderType\n        e.retryCount = this._retryCount\n\n        let error = e\n        if (transformError) {\n          error = transformError(error) || error\n        }\n\n        if (onRetryError && this._retryCount > 0) onRetryError(error, this._retryCount, {index: rest.index, vid: rest.vid, range: rest.range, priOptions: rest.priOptions})\n\n        this._retryCount++\n        let isRetry = true\n        if (this._retryCheckFunc) {\n          isRetry = this._retryCheckFunc(e)\n        }\n        if (isRetry && this._retryCount <= retry) {\n          clearTimeout(this._retryTimer)\n          this._logger.debug('[task request setTimeout],retry', this._retryCount, ',retry range,', rest.range)\n          this._retryTimer = setTimeout(request, retryDelay)\n          return\n        }\n        this.promise.reject(error)\n      }\n    }\n\n    request()\n    return this.promise\n  }\n\n  async cancel () {\n    clearTimeout(this._retryTimer)\n    this._canceled = true\n    this._loader.running = false\n    return this._loader.cancel()\n  }\n\n  get running () {\n    return this._loader && this._loader.running\n  }\n\n  get loader () {\n    return this._loader\n  }\n}\n","export function isMediaPlaying (media) {\n  return media && !media.paused && !media.ended && media.playbackRate !== 0 && media.readyState !== 0\n}\n\nexport function getVideoPlaybackQuality (video) {\n  if (!video) return {}\n  if (typeof video.getVideoPlaybackQuality === 'function') {\n    const info = video.getVideoPlaybackQuality()\n    return {\n      droppedVideoFrames: info.droppedVideoFrames || info.corruptedVideoFrames,\n      totalVideoFrames: info.totalVideoFrames,\n      creationTime: info.creationTime\n    }\n  }\n\n  return {\n    droppedVideoFrames: video.webkitDroppedFrameCount,\n    totalVideoFrames: video.webkitDecodedFrameCount,\n    creationTime: performance.now()\n  }\n}\n\n/**\n * @param {Array.<Uint8Array>} arr\n * @returns\n */\nexport function concatUint8Array (...arr) {\n  arr = arr.filter(Boolean)\n  if (arr.length < 2) return arr[0]\n  const data = new Uint8Array(arr.reduce((p, c) => p + c.byteLength, 0))\n  let prevLen = 0\n  arr.forEach((d) => {\n    data.set(d, prevLen)\n    prevLen += d.byteLength\n  })\n  return data\n}\n\nexport function sleep (t = 0) {\n  return new Promise((resolve) => setTimeout(resolve, t))\n}\n","import { FetchLoader } from './fetch'\nimport { LoaderType, ResponseType } from './types'\nimport { getConfig } from './config'\nimport { Task } from './task'\nimport { isPlainObject } from '../is'\nimport { sleep } from '../streaming-helper'\nimport { EVENT } from '../event'\nimport EventEmitter from 'eventemitter3'\n\nexport {\n  LoaderType,\n  ResponseType\n}\n\nexport class NetLoader extends EventEmitter {\n  type = LoaderType.FETCH\n\n  _queue = []\n\n  _alive = []\n\n  _currentTask = null\n\n  _config\n\n  constructor (cfg) {\n    super(cfg)\n    this._config = getConfig(cfg)\n    if (\n      this._config.loaderType === LoaderType.XHR ||\n      !FetchLoader.isSupported()\n    ) {\n      this.type = LoaderType.XHR\n    }\n    this.log = cfg.logger\n  }\n\n  isFetch () {\n    return this.type === LoaderType.FETCH\n  }\n\n  static isFetchSupport () {\n    return FetchLoader.isSupported()\n  }\n\n  load (url, config = {}) {\n    if (typeof url === 'string' || !url) {\n      config.url = url || config.url || this._config.url\n    } else {\n      config = url\n    }\n\n    config = Object.assign({}, this._config, config)\n    if (config.params) config.params = Object.assign({}, config.params)\n    if (config.headers && isPlainObject(config.headers)) config.headers = Object.assign({}, config.headers)\n    if (config.body && isPlainObject(config.body)) config.body = Object.assign({}, config.body)\n\n    if (config.transformRequest) {\n      config = config.transformRequest(config) || config\n    }\n    config.logger = this.log\n\n    const task = new Task(this.type, config)\n    task.loader.on(EVENT.REAL_TIME_SPEED, (data) => {\n      this.emit(EVENT.REAL_TIME_SPEED, data)\n    })\n    this._queue.push(task)\n    if (this._queue.length === 1 && (!this._currentTask || !this._currentTask.running)) {\n      this._processTask()\n    }\n\n    return task.promise\n  }\n\n  async cancel () {\n    const cancels = this._queue.map(t => t.cancel()).concat(this._alive.map(t => t.cancel()))\n    if (this._currentTask) {\n      cancels.push(this._currentTask.cancel())\n    }\n    this._queue = []\n    this._alive = []\n    await Promise.all(cancels)\n    await sleep()\n  }\n\n  _processTask () {\n    this._currentTask = this._queue.shift()\n    if (!this._currentTask) return\n\n    if (this._currentTask.alive) {\n      this._alive.push(this._currentTask)\n    }\n    const req = this._currentTask.exec().catch(e => {})\n\n    if (!(req && typeof req.finally === 'function')) return\n\n    req.finally(() => {\n      if (this._currentTask?.alive && this._alive?.length > 0) {\n        this._alive = this._alive.filter(task => task && task !== this._currentTask)\n      }\n      this._processTask()\n    })\n\n  }\n}\n","import { LoaderType, ResponseType } from './types'\n\nexport function getConfig (cfg) {\n  return {\n    loaderType: LoaderType.FETCH,\n    retry: 0,\n    retryDelay: 0, // ms\n    timeout: 0,\n    request: null, // Request\n    onTimeout: undefined,\n    onProgress: undefined,\n    onRetryError: undefined,\n    transformRequest: undefined,\n    transformResponse: undefined,\n    transformError: undefined,\n    responseType: ResponseType.TEXT,\n    range: undefined,\n    url: '',\n    params: undefined,\n    method: 'GET',\n    headers: {},\n    body: undefined,\n    mode: undefined,\n    credentials: undefined,\n    cache: undefined,\n    redirect: undefined,\n    referrer: undefined,\n    referrerPolicy: undefined,\n    integrity: undefined,\n    onProcessMinLen: 0,\n    ...cfg\n  }\n}\n","import { Buffer } from '../buffer'\n\nexport class GapService {\n  _prevCurrentTime = 0\n\n  do (media, maxJumpDistance = 3, isLive, seekThreshold = 1) {\n    if (!media) return\n\n    const currentTime = media.currentTime\n    let jumpTo = 0\n\n    if (this._prevCurrentTime === currentTime) {\n      const info = Buffer.info(Buffer.get(media), currentTime)\n      if (!info.buffers.length) return\n\n      if (\n        (isLive && info.nextStart) ||\n        (info.nextStart && info.nextStart - currentTime < maxJumpDistance)\n      ) {\n        jumpTo = info.nextStart + 0.1\n      } else if (info.end && info.end - currentTime > seekThreshold && !media.seeking) {\n        jumpTo = currentTime + 0.1\n      }\n    }\n\n    this._prevCurrentTime = currentTime\n\n    if (jumpTo && currentTime !== jumpTo) {\n      media.currentTime = jumpTo\n    }\n  }\n}\n","import { EVENT } from '../event'\n\nexport class SeiService {\n  _seiSet = new Set()\n\n  constructor (emitter) {\n    this.emitter = emitter\n\n    emitter.on(EVENT.SEI, (sei) => {\n      if (sei) this._seiSet.add(sei)\n    })\n  }\n\n  throw (currentTime) {\n    if (currentTime === null || currentTime === undefined || !this._seiSet.size) return\n    const min = currentTime - 0.2\n    const max = currentTime + 0.2\n    const toThrow = []\n    this._seiSet.forEach(sei => {\n      if (sei.time >= min && sei.time <= max) {\n        toThrow.push(sei)\n      }\n    })\n\n    toThrow.forEach((sei) => {\n      this._seiSet.delete(sei)\n      this.emitter.emit(EVENT.SEI_IN_TIME, sei)\n    })\n  }\n\n  reset () {\n    this._seiSet.clear()\n  }\n}\n","export class BandwidthService {\n  _chunkSpeeds = [] // bps\n  _speeds = [] // bps\n\n  addRecord (totalByte, ms) {\n    if (!totalByte || !ms) return\n    this._speeds.push(8000 * totalByte / ms)\n    this._speeds = this._speeds.slice(-3)\n  }\n\n  addChunkRecord (totalByte, ms) {\n    if (!totalByte || !ms) return\n    this._chunkSpeeds.push(8000 * totalByte / ms)\n    this._chunkSpeeds = this._chunkSpeeds.slice(-100)\n  }\n\n  getAvgSpeed () {\n    if (!this._chunkSpeeds.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds.reduce((a, c) => (a += c)) / this._speeds.length\n    }\n    return this._chunkSpeeds.reduce((a, c) => (a += c)) / this._chunkSpeeds.length\n  }\n\n  getLatestSpeed () {\n    if (!this._chunkSpeeds.length && !this._speeds.length) return 0\n    if (this._speeds.length) {\n      return this._speeds[this._speeds.length - 1]\n    }\n    return this._chunkSpeeds[this._chunkSpeeds.length - 1]\n  }\n\n  reset () {\n    this._chunkSpeeds = []\n    this._speeds = []\n  }\n}\n","import { EVENT } from 'xgplayer-streaming-shared'\n\nclass Stats {\n  encodeType = '' // hevc | avc\n  audioCodec = ''\n  videoCodec = ''\n  domain = '' // stream url domain\n  fps = 0\n  bitrate = 0 // 最新1s下载数据的码率\n  width = 0\n  height = 0\n  samplerate = 0\n  channelCount = 0\n  gop = 0 // 第一个gop帧数\n\n  _bitsAccumulateSize = 0\n  _bitsAccumulateDuration = 0\n\n  constructor (timescale) {\n    this._timescale = timescale\n  }\n\n  getStats () {\n    return {\n      encodeType: this.encodeType,\n      audioCodec: this.audioCodec,\n      videoCodec: this.videoCodec,\n      domain: this.domain,\n      fps: this.fps,\n      bitrate: this.bitrate,\n      width: this.width,\n      height: this.height,\n      samplerate: this.samplerate,\n      channelCount: this.channelCount,\n      gop: this.gop\n    }\n  }\n\n  setEncodeType (encode) {\n    this.encodeType = encode\n  }\n\n  setFpsFromScriptData ({data}) {\n    const fps = data?.onMetaData?.framerate\n    if (fps && fps > 0 && fps < 100) {\n      this.fps = fps\n    }\n  }\n\n  setVideoMeta (track) {\n    this.width = track.width\n    this.height = track.height\n    this.videoCodec = track.codec\n    this.encodeType = track.codecType\n    if (track.fpsNum && track.fpsDen) {\n      const fps = track.fpsNum / track.fpsDen\n      if (fps > 0 && fps < 100) {\n        this.fps = fps\n      }\n    }\n  }\n\n  setAudioMeta (track) {\n    this.audioCodec = track.codec\n    this.samplerate = track.sampleRate\n    this.channelCount = track.channelCount\n  }\n\n  setDomain (responseUrl) {\n    this.domain = responseUrl.split('/').slice(2, 3)[0]\n  }\n\n  updateBitrate (samples) {\n    if (!this.fps || this.fps >= 100) {\n      if (samples.length) {\n        const duration = samples.reduce((a,b) => a += b.duration, 0) / samples.length\n        this.fps = Math.round(this._timescale / duration)\n      }\n    }\n    samples.forEach(sample => {\n      if (sample.gopId === 1) {\n        this.gop++\n      }\n      this._bitsAccumulateDuration += sample.duration / (this._timescale / 1000)\n      this._bitsAccumulateSize += sample.units.reduce((a, c) => (a += c.length), 0)\n      if (this._bitsAccumulateDuration >= 1000) {\n        this.bitrate = this._bitsAccumulateSize * 8\n        this._bitsAccumulateDuration = 0\n        this._bitsAccumulateSize = 0\n      }\n    })\n  }\n}\n\n\n/**\n * @typedef {Object} StatsInfo\n * @property {number} downloadSpeed\n * @property {number} avgSpeed\n * @property {number} currentTime\n * @property {number} bufferEnd\n * @property {number} decodeFps\n * @property {string} encodeType\n * @property {string} audioCodec\n * @property {string} videoCodec\n * @property {string} domain\n * @property {number} fps\n * @property {number} bitrate\n * @property {number} width\n * @property {number} height\n * @property {number} samplerate\n * @property {number} channelCount\n * @property {number} gop\n */\nclass MediaStatsService {\n\n  _core = null\n\n  _samples = []\n\n  constructor (core, timescale = 1000) {\n    this._core = core\n    this._timescale = timescale\n    this._stats = new Stats(timescale)\n    this._bindEvents()\n  }\n\n\n  /** @returns {StatsInfo} */\n  getStats () {\n    const { currentTime = 0, decodeFps = 0 } = this._core?.media || {}\n    return {\n      ...this._stats.getStats(),\n      downloadSpeed: this._core?.speedInfo?.().speed || 0,\n      avgSpeed: this._core?.speedInfo?.().avgSpeed || 0,\n      currentTime,\n      bufferEnd: this._core?.bufferInfo()?.remaining || 0,\n      decodeFps\n    }\n  }\n\n  _bindEvents () {\n    this._core.on(EVENT.DEMUXED_TRACK, ({videoTrack}) => this._stats.updateBitrate(videoTrack.samples))\n\n    this._core.on(EVENT.FLV_SCRIPT_DATA, data => {\n      this._stats.setFpsFromScriptData(data)\n    })\n\n    this._core.on(EVENT.METADATA_PARSED, e => {\n      if (e.type === 'video') {\n        this._stats.setVideoMeta(e.track)\n      } else {\n        this._stats.setAudioMeta(e.track)\n      }\n    })\n\n    this._core.on(EVENT.TTFB, e => {\n      this._stats.setDomain(e.responseUrl)\n    })\n\n  }\n\n  reset () {\n    this._samples = []\n    this._stats = new Stats(this._timescale)\n  }\n\n}\n\nexport { MediaStatsService }\n","import * as mse from './mse'\nimport * as buffer from './buffer'\nimport * as net from './net'\nimport * as error from './error'\nimport * as event from './event'\nimport * as services from './services'\nimport * as streamingHelper from './streaming-helper'\nimport { Logger } from './logger'\n\nexport default {\n  ...mse,\n  ...buffer,\n  ...net,\n  ...error,\n  ...event,\n  ...services,\n  ...streamingHelper,\n  Logger\n}\n"],"names":["createPublicPromise","res","rej","promise","Promise","resolve","reject","used","apply","arguments","nowTime","parseInt","performance","now","e","Date","getTime","Buffer","_classCallCheck","key","value","buf","length","end","start","b","buffered","error","maxHole","buffers","i","l","bufLen","last","lastEnd","push","reduce","a","c","pos","undefined","index","nextStart","nextEnd","prevStart","prevEnd","item","currentTime","behind","remaining","totalLength","ERR","MANIFEST","NETWORK","NETWORK_TIMEOUT","NETWORK_FORBIDDEN","NETWROK_RANGE_NOT_SATISFIABLE","DEMUX","REMUX","MEDIA","DRM","OTHER","RUNTIME","SUB_TYPES","FLV","HLS","MP4","FMP4","MSE_ADD_SB","MSE_APPEND_BUFFER","MSE_OTHER","MSE_FULL","OPTION","DASH","LICENSE","CUSTOM_LICENSE","MSE_HIJACK","EME_HIJACK","SIDX","NO_CANPLAY_ERROR","BUFFERBREAK_ERROR","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_CODEC_NOT_SUPPORTED","MEDIA_ERR_URL_EMPTY","ERR_CODE","_defineProperty","_ERR_CODE","StreamingError","_Error","_inherits","_super","_createSuper","type","subType","origin","payload","msg","_this","call","message","errorType","originError","ext","errorCode","errorMessage","Error","_error$response","isTimeout","url","response","httpCode","status","isBrowser","window","LogCacheLevel","DEBUG","LOG","WARN","ERROR","SIMPLE_TYPE","Logger","name","config","this","_prefix","concat","disabled","logCacheLevel","logMaxSize","logSize","logTextArray","_createClass","_console","_len","args","Array","_key","logCache","console","debug","_console2","_len2","_key2","log","_console3","_len3","_key3","warn","_console4","_len4","_key4","text","_len5","logText","_key5","finLogText","map","logable","JSON","stringify","delLog","shift","join","reset","_console5","group","table","groupEnd","val","toLocaleString","reduceDepth","_typeof","objType","Object","prototype","toString","slice","obj","maxDepth","depth","result","includes","hasOwnProperty","MediaSource","getMediaSource","OP_NAME","MSEError","MSE","media","_this2","create","queue","_queue","op","costtime","_opst","_logger","opName","context","_startQueue","event","_config","assign","getDefaultConfig","bindMedia","openLog","enable","_enqueueBlockingOp2","_unbindMedia","_bindMedia","get","_this$mediaSource","mediaSource","readyState","_url","_this$mediaSource2","duration","_mseFullFlag","VIDEO","_this3","_enqueueBlockingOp","isEnded","_this4","_openPromise","isOpened","ms","addEventListener","onOpen","_st","removeEventListener","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this5","wrap","_context","prev","next","unbindMedia","revokeObjectURL","src","URL","createObjectURL","abrupt","stop","_x","_callee2","hasMetadata","mseOpen","_this6","_context2","keys","forEach","t","x","endOfStream","_sourceBuffer","k","removeSourceBuffer","removeAttribute","load","mimeType","sb","addSourceBuffer","_onSBUpdateEnd","bind","_onSBUpdateError","_this7","changeType","_enqueueOp","createSource","buffer","_this8","byteLength","_this8$_sourceBuffer$","appendBuffer","startTime","endTime","_this9","isInsertHead","remove","p","_this10","_this11","_this$_queue$type","initOpque","isinit","reason","_this12","setLiveSeekableRange","exec","_this13","splice","then","_callee3","types","waiters","_this14","_context3","prom","all","updating","_x2","_x3","indexOf","timestampOffset","_this15","_this16","abort","mime","isTypeSupported","UPDATE_ERROR","LoaderType","FETCH","XHR","ResponseType","ARRAY_BUFFER","TEXT","NetError","request","_assertThisInitialized","isPlainObject","getPrototypeOf","getRangeValue","ret","encode","encodeURIComponent","replace","setUrlParams","params","v","str","isArray","toISOString","isObject","filter","Boolean","hashIndex","createResponse","data","done","contentLength","age","firstByteTime","range","vid","priOptions","parseFloat","Number","isNaN","options","calculateSpeed","byteLen","millisec","Math","round","EVENT","TTFB","LOAD_START","LOAD_RESPONSE_HEADERS","LOAD_COMPLETE","LOAD_RETRY","SOURCEBUFFER_CREATED","ANALYZE_DURATION_EXCEEDED","REMOVE_BUFFER","BUFFEREOS","KEYFRAME","METADATA_PARSED","SEI","SEI_IN_TIME","FLV_SCRIPT_DATA","LOWDECODE","SWITCH_URL_SUCCESS","SWITCH_URL_FAILED","SPEED","HLS_MANIFEST_LOADED","HLS_LEVEL_LOADED","DEMUXED_TRACK","STREAM_EXCEPTION","LARGE_AV_FIRST_FRAME_GAP_DETECT","LARGE_VIDEO_DTS_GAP_DETECT","LARGE_AUDIO_DTS_GAP_DETECT","AUDIO_GAP_DETECT","AUDIO_OVERLAP_DETECT","MAX_DTS_DELTA_WITH_NEXT_SEGMENT_DETECT","REAL_TIME_SPEED","has","prefix","Events","EE","fn","once","addListener","emitter","TypeError","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","names","events","getOwnPropertySymbols","listeners","handlers","ee","listenerCount","emit","a1","a2","a3","a4","a5","len","removeListener","j","on","removeAllListeners","off","prefixed","module","exports","CACHESIZE","FetchLoader","_EventEmitter","_cancel","_ref","_this$_abortControlle","timeout","responseType","onProgress","onTimeout","onCancel","transformResponse","logger","method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","onProcessMinLen","_aborted","_onProcessMinLen","_onCancel","_abortController","AbortController","_running","_index","_range","_vid","_priOptions","init","signal","clearTimeout","_timeoutTimer","rangeValue","Headers","append","Range","setTimeout","cancel","fetch","_ref2","costTime","speed","_response","ok","sent","json","_loadChunk","arrayBuffer","Uint8Array","time","catch","_error","_reader","t0","st","getReader","err","_cache","_writeIdx","reader","pump","_ref3","_this3$_range","startRange","startByte","curLen","retData","temp","read","_receivedLength","set","XhrLoader","req","_onProgress","_headers","_withCredentials","_body","_method","_timeout","_runing","_responseType","_firstRtt","_onTimeout","_request","_loadCompleteResolve","_loadCompleteReject","_startLoad","chunkSize","_currentChunkSizeKB","from","to","_internalOpen","_startTime","xhr","_xhr","XMLHttpRequest","open","withCredentials","onload","_onLoad","onreadystatechange","_onReadyStatechange","onerror","errorEvent","_errorEvent$currentTa","_errorEvent$currentTa2","_errorEvent$currentTa3","currentTarget","statusText","ontimeout","setRequestHeader","send","target","_this$_range","_objectSpread","byteStart","_this$_range2","chunk","responseURL","_getHeaders","_transformResponse","_getPrototypeOf","_step","_iterator","_createForOfIteratorHelper","getAllResponseHeaders","trim","split","s","n","parts","toLowerCase","f","Task","alive","_loaderType","_loader","_retryCount","_retryTimer","_canceled","_retryCheckFunc","retryCheckFunc","_this$_config","retry","retryDelay","onRetryError","transformError","rest","_objectWithoutProperties","_excluded","isRetry","running","loaderType","retryCount","sleep","paused","ended","playbackRate","video","getVideoPlaybackQuality","info","droppedVideoFrames","corruptedVideoFrames","totalVideoFrames","creationTime","webkitDroppedFrameCount","webkitDecodedFrameCount","arr","prevLen","d","NetLoader","cfg","transformRequest","integrity","getConfig","isSupported","task","loader","_currentTask","_processTask","cancels","_alive","finally","_this3$_currentTask","_this3$_alive","GapService","maxJumpDistance","isLive","seekThreshold","jumpTo","_prevCurrentTime","seeking","SeiService","Set","sei","_seiSet","add","size","min","max","toThrow","delete","clear","BandwidthService","totalByte","_speeds","_chunkSpeeds","Stats","timescale","_timescale","encodeType","audioCodec","videoCodec","domain","fps","bitrate","width","height","samplerate","channelCount","gop","_data$onMetaData","onMetaData","framerate","track","codec","codecType","fpsNum","fpsDen","sampleRate","responseUrl","samples","sample","gopId","_bitsAccumulateDuration","_bitsAccumulateSize","units","MediaStatsService","core","_core","_stats","_bindEvents","_this$_core","_this$_core2","_this$_core2$speedInf","_this$_core3","_this$_core3$speedInf","_this$_core4","_this$_core4$bufferIn","_ref2$currentTime","_ref2$decodeFps","decodeFps","getStats","downloadSpeed","speedInfo","avgSpeed","bufferEnd","bufferInfo","videoTrack","updateBitrate","setFpsFromScriptData","setVideoMeta","setAudioMeta","setDomain","_samples","mse","net","services","streamingHelper"],"mappings":"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"}